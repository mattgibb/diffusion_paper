%!TEX root = ../diffusion_paper.tex
\section{Introduction} % (fold)
\label{sec:introduction}
  \IEEEPARstart{A}{ll} 3D histology reconstruction methods are based on the acquisition of individual 2D histology images, whether from scans of the un-cut surface of the embedded tissue (so-called block face imaging) \cite{Sands2005,Sands2006,Rutherford2012}, or as sections \cite{Burton2006,Plank2009}. In the former case, 2D images are intrinsically registered, and so no alignment is necessary. In the latter case, images are brought into alignment either through registration amongst themselves, or to a coherent reference volume. It will be seen that the most recent methods draw together the advantages of both techniques.
  
  In 2002, Hooks et al. \cite{Hooks2002} sectioned a 0.8 x 0.8 x 3.7mm transmural segment of rat left ventricle and recorded an intrinsically registered volume image of cubic-1.56$\mu$m resolution using confocal microscopy. The resulting volume images were more detailed than any that had been seen before. Using similar techniques in 2012, Rutherford et al. \cite{Rutherford2012} produced a 5.6mm$^3$ volume surrounding a rat anterior left ventricular infarct, with cubic-1$\mu$m resolution. Unfortunately, this approach cannot resolve tissue sections much larger than the samples presented, and certainly not an entire heart.
  
  Adjacent whole-organ histological images are, in the main, extremely similar in shape, have an extremely similar colour profile and are obtained at the same spatial resolution. These characteristics together make for highly accurate and reliable coregistration. Starting from the first slice in a dataset, previous approaches have registered each successive slice to its predecessor, thus constructing a coherent volume \cite{Chakravarty2006,Schmitt2006,Cifor2009,Cifor2011}. However, there are several unacceptable characteristics of volumes generated with these techniques. Because each slice is positioned relative to the previous, the displacement due to any single erroneous registration is propagated to every subsequent slice. Furthermore, the volumes suffer from what is known as the `z-shift effect' \cite{Yushkevich2006} or the `banana problem' \cite{Malandain2004,Lyon2012}, stemming from the fact that if a curved banana were sliced evenly and perpendicularly to its length, a volume obtained with a slice-to-slice method would appear straight, having lost the original curvature of the banana. In the case of whole-organ histology, volumes approach maximum pairwise symmetry, bearing, if any, a merely coincidental relation to the large-scale geometry of the sample. Finally in this case, only rigid registration may be used, because if the size or shape of slices were unconstrained, every slice would approximate the dimensions of the first, and the organ would approximate a fleshy cylinder.
  
  Registering slices to a reference volume circumvents the banana problem. Burton et al. \cite{Burton2006} paved the way for this conjunction by providing MRI rabbit cardiac images of 26.4 x 26.4 x 24.4$\mu$m voxel size with 1.1 x 1.1 x 10$\mu$m histology stacks of the same hearts, and exhibited an initial attempt at slice alignment, guided by the MRI data. Since then, an automated pipeline has been developed, applying iterative 2D and 3D optimised deformations to register the stacks into the MRI geometry \cite{Mansoori2007}. Despite some success with this procedure, the slices are ultimately registered to 2D MRI image that does not correspond to the histology, and the unconstrained non-rigid registration that was employed in the final stage led to unrealistic tissue distortions. These problems notwithstanding, the direct registration of histology to MRI is the best way to move towards global shape correctness if no other reference data is available, and is still a common procedure \cite{Alic2011,Osechinskiy2011,Kimm2012}.
  
  Block face images, taken from the surface of the fixated tissue volume before sectioning, provide an intrinsically coherent and precisely corresponding set of reference images. Although suitable for low-resolution alignment  \cite{Palm2010}, the reference images are very different in appearance to the histology, often with a much lower spatial resolution, hindering accurate alignment. Even very small imperfections in the final mappings introduces jaggedness that renders volumetric microstructure almost imperceptible. Algorithms have been proposed to smooth out this noise through the more precise and reliable coregistration of adjacent slices, in both a sequential \cite{Yushkevich2006,Chakravarty2008} and simultaneous \cite{Feuerstein2011} manner. However, these methods are highly parameterised, often involving registrations at a number of scales, using only a subset of the image information available, and are often based on essentially subjective segmentations, rather than purely original images. Furthermore, only the nearest two neighbouring slices are used to dampen transformational noise, and therefore only the very highest frequency of noise can ever be reduced.
  
  Yushkevich et al. attempt to correct for the banana effect in serially registered mouse \cite{Yushkevich2006} and human \cite{Adler2012} brain histological volumes. They first perform a rigid-body banana registration to approximate the dimensions of a full brain volume. Clearly, if a transform less constrained than rigid-body were used, then each slice would resemble the size and, depending on the constraint of the transform, the shape of the first reference slice. A prism-like volume would result, entirely unrelated to the true geometry of the organ. The volume produced from registering each section directly to the MRI is jagged, and so the transform parameters from the banana volume to the MRI-registered volume are Gaussian smoothed. This approach goes a long way to combining the global fidelity of anchoring to a reference volume and the local smoothness of adjacent slice registration. Yet smoothness is limited by the level of success of the individual inter-slice registrations; any error or discontinuity in the serial volume will be transduced directly into the final result. In particular, any differential deformation of adjacent slices during sectioning, either affine or curved, could not be resolved by the rigid-body banana registration.
  
  No mention of non-rigid transforms is mentioned in the Yushkevich implementation. But conceivably, non-rigid interslice registrations could be integrated into the pipeline once the MRI correspondence planes had been established, initialised from the terminus of the rigid registrations. Gaussian smoothing would be applied to the transforms from the non-rigid, prism-like banana volume to the reference volume. Volumes would certainly be smoother than with the rigid smoothing, as adjacent non-rigid differences have been relaxed. Yet inevitable occasional errors and inaccuracies in alignment would still be present, as slices are only given one algorithmic run to align, and even subsequent registrations may be trapped by local minima.
  
  Chakravarty et al. \cite{Chakravarty2008} first rigidly align sections of whole mouse brain to an associated block face set, then apply a deformation field transformation to each slice, calculated as the mean of the parameters from defomation fields registering it to the two neighbouring slices. While this may go some way to reducing noise from the block face registrations, the maximum distance of information transfer is one slice, and so only the maximum distortion frequency will be damped.
  
  Techniques have been developed to combine monomodal adjacent slice and multimodal reference registrations simultaneously. Palm et al. \cite{Palm2008} expound a `weighted multi-image mutual information metric', optimising the sum of scaled contributions from both cost functions, and Feuerstein et al. \cite{Feuerstein2011} combine two potential energy functions in a Markov random field model to reconstruct a rat kidney. Not only do these methods require extraneous parameterisation and tuning, but in practice, the superposed cost function will form several distinct local minima; rather than reaching an averaged compromise between the reference images, the optimisation will arrive close to one preferred of several single-image minima, depending on the relative weightings and the transform initialisation.
  
  Finally, \cite{Arganda-Carreras2010} offer an interesting and robust approach to combining monomodal and multimodal alignments, using consistent b-spline-based elastic registrations. Multiple iterations of triple-wise registrations gradually share information in the z-direction and result in smoothing through a spectrum of scales. However, the choice of simultaneous registration leads to the same problem of multiple local minima faced by \cite{Palm2008,Feuerstein2011}.
  
  Enter what will be referred to as `transformational diffusion smoothing': a novel technique incorporating the best features from reference-based and slice-to-slice registration methods, and eliminating the weaknesses of both. The last four sections introduce and detail transformational diffusion smoothing in full, in a manner driven by the requirements of the problem at hand. A revision of the theoretical underpinnings of 1-dimensional Brownian motion is followed by some simple simulation of diffusion on a discrete grid. In a similar vein, a mathematical exposition of transformational diffusion is followed by its application upon a simulated geometry with added artificial affine noise.
  
  % \hfill mds
  %  
  % \hfill January 11, 2007
  % 
  
  % needed in second column of first page if using \IEEEpubid
  %\IEEEpubidadjcol

% section introduction (end)
